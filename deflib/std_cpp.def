include: std_c.def
## frame
subcode: basic_frame
    $include <cstdio>
    $include <string>

    $call @global
    $(if:hascode:n_main)
	$list n_main
    $(if:hascode:main2)
	$list main2

#---- stl containers ---------------
subcode:: _autoload
    $register_prefix(vn) vector<int>
    $register_prefix(rvn) vector<int> &

    $register_prefix(vs) vector<string>
    $register_prefix(rvs) vector<string> &

subcode: vector_push(v, @list)
    $include <vector>
    $(for:t in $(list))
	$(v).push_back($(t))

subcode: stl_iterator(m)
    $get_type(type) $(m)
    $local $(type)::const_iterator got

#---- stl query ----
subcode: map_has(m, key)
    $(allow_recurse:10)
    $call stl_iterator, $(m)
    got=$(m).find($(key))
    $if got!=$(m).end()
	$(set:value=got->second)
	BLOCK

subcode: set_has(m, key)
    $(allow_recurse:10)
    $call stl_iterator, $(m)
    got=$(m).find($(key))
    $if got!=$(m).end()
	BLOCK

#---- stl iteration ----
subcode: map_iter(m)
    $call stl_iterator, $(m)
    $for got=$(m).begin();got!=$(m).end();++got
	$(set:key=got->first)
	$(set:value=got->second)
	BLOCK

subcode: set_iter(m)
    $call stl_iterator, $(m)
    $for got=$(m).begin();got!=$(m).end();++got
	$(set:item=(*got))
	BLOCK

#---- stl initilization ----
subcode: vector_append(vec, val)     
    $(vec).push_back($(val))         

subcode: set_insert(set, val)
    $(set).insert($(val))
