page: mydef_filter
    type: pl
    output_dir: script
    subcode: main
	my $pre_indent
	my $indent=0
	$while <STDIN>
	    $if !defined $pre_indent
		$if /^(\s*)/
		    my $space=$1
		    $pre_indent=$space
	    my $space=$pre_indent . "    " x $indent

	    $if /^\s*(foreach)\s*(.*)\((.*)\)\s*\{\s*$/
		my ($tag, $var, $cond)=($1, $2, $3)
		$var=~s/^my\s*//
		$var=~s/\s*$//
		print "$space\$foreach $var in $cond\n"
		$indent++
	    $elif /^\s*(\w+)\s*\((.*)\)\s*\{\s*$/
		my ($tag, $cond)=($1, $2)
		print "$space\$$tag $cond\n"
		$indent++
	    $elif /^\s*else\s*\{\s*$/
		print "$space\$else\n"
		$indent++
	    $elif /^\s*(sub)\s*(\w+)\s*\{\s*$/
		my ($tag, $subname)=($1, $2)
		print "$space\$sub $subname\n"
		$indent++

	    $elif /^\s*(\w+)\s*\((.*)\)\s*\{\s*(.*)\s*\}\s*$/
		# if(){}
		my ($tag, $cond, $code)=($1, $2, $3)
		print "$space\$$tag $cond\n"
		print "$space    $code\n"
	    $elif /^\s*else\s*\{\s*(.*)\s*\}\s*$/
		my $code=$1
		print "$space\$else\n"
		print "$space    $code\n"
	    $elif /^\s*\}/
		$indent--
	    $elif /^\s*(.*)/
		print "$space$1\n"


